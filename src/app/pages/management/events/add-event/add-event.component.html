<nb-card class="col-md-12 col-lg-12 col-xxxl-12">
    <nb-card-body>
        <nb-stepper orientation="horizontal">
            <nb-step label="Basic Information">
                <h5>Basic Information</h5>
                <ng-container [ngTemplateOutlet]="basicInformationTemplate"></ng-container>
                <button nbButton disabled nbStepperNext>prev</button>
                <button class="float-right" nbButton nbStepperNext>next</button>
            </nb-step>
            <nb-step label="Feedback Form">
                <h5>Feedback Form</h5>
                <ng-container [ngTemplateOutlet]="feedbackFormTemplate"></ng-container>
                <button nbButton nbStepperPrevious>prev</button>
                <button class="float-right" nbButton nbStepperNext>next</button>
            </nb-step>
            <nb-step label="Attendance List">
                <h5>Attendance List</h5>
                <ng-container [ngTemplateOutlet]="attendanceListTemplate"></ng-container>
                <button nbButton nbStepperPrevious>prev</button>
                <button class="float-right" nbButton nbStepperNext>next</button>
            </nb-step>
            <nb-step label="Tasks">
                <h5>Tasks</h5>
                <ng-container [ngTemplateOutlet]="tasksTemplate"></ng-container>
                <button nbButton nbStepperPrevious>prev</button>
                <button class="float-right" nbButton nbStepperNext (click)="review()">next</button>
            </nb-step>
            <nb-step label="Review">
                <h3>Review</h3>
                <button nbButton nbStepperPrevious>prev</button>
                <button class="float-right" nbButton status="primary" (click)="createEvent()">Create</button>
            </nb-step>
        </nb-stepper>
    </nb-card-body>
</nb-card>
<ng-template #basicInformationTemplate>
<nb-card>
    <nb-card-body class="example-items-col">
        <div class="form-group">
            <label for="title" class="font-weight-bold">Title</label>
            <input type="text" [(ngModel)]="title" nbInput fullWidth id="title" placeholder="Title">
        </div>
        <div class="form-group row">
            <div class="col-md-6">
                <label for="proposal" class="font-weight-bold" style="margin-top: 1rem;">Proposal</label>
                <input [(ngModel)]="proposalId" nbInput fullWidth type="text" placeholder="Search proposal"
                    [nbAutocomplete]="auto" id="proposal" />
                <nb-autocomplete #auto [activeFirst]="true">
                    <nb-option *ngFor="let option of filteredOptions$ | async" [value]="option">
                        {{ option }}
                    </nb-option>
                </nb-autocomplete>
            </div>
            <div class="col-md-6">
                <label for="semester" class="font-weight-bold" style="margin-top: 1rem;">Semester</label>
                <input type="text" [(ngModel)]="semester" disabled nbInput fullWidth id="semester" placeholder="Title">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <label for="startTime" class="font-weight-bold" style="margin-top: 1rem;">Start time</label>
                <div class="d-flex">
                    <input class="w-75" type="datetime" [(ngModel)]="startTime" nbInput id="startTime" placeholder="Start time"  [nbDatepicker]="dateTimePicker">
                    <nb-datepicker #dateTimePicker></nb-datepicker>
                    <input class="w-25" nbInput [(ngModel)]="startTime" [nbTimepicker]="timepicker">
                    <nb-timepicker #timepicker></nb-timepicker>
                </div>
                
            </div>
            <div class="col-md-6">
                <label for="duration" class="font-weight-bold" style="margin-top: 1rem;">Duration</label>
                <div class="d-flex align-items-baseline">
                    <nb-select (selectedChange)="changeDuration($event, 'hour')" class="mr-2">
                        <nb-option *ngFor="let hour of hours" [value]="hour"> {{ hour }}</nb-option>
                    </nb-select> hours
                    <nb-select (selectedChange)="changeDuration($event, 'minute')" class="mx-2">
                        <nb-option *ngFor="let minute of minutes" [value]="minute"> {{ minute }}</nb-option>
                    </nb-select> minutes
                </div>
            
                <!-- <input type="number" [(ngModel)]="duration" nbInput fullWidth id="duration" placeholder="Duration">  -->
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <label for="status" class="font-weight-bold" style="margin-top: 1rem;">Status</label>
                <nb-select [(selected)]="status" fullWidth class="d-block">
                    <nb-option value="0">Non Public</nb-option>
                    <nb-option value="1">Public</nb-option>
                    <nb-option value="2">Draft</nb-option>
                </nb-select>
            </div>
            <div class="col-md-6">
                <label for="attendScore" class="font-weight-bold" style="margin-top: 1rem;">Attend Score</label>
                <input type="number" min="0" onkeydown="return event.key !== '-'" [(ngModel)]="attendScore" nbInput fullWidth id="attendScore" placeholder="Attend Score">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <label class="font-weight-bold" style="margin-top: 1rem;">Event Leader</label>
                <ngx-custom-autoselect
                    [arr]="managerList"
                    [property]="'name'"
                    (selectItem)="setEventLeaderRollnumber($event)"
                ></ngx-custom-autoselect>
            </div>
        </div>
        <div class="form-group">
            <label for="description" class="font-weight-bold" style="margin-top: 1rem;">Content</label>
            <!-- <textarea nbInput fullWidth id="description" placeholder="Textarea"></textarea> -->
            <quill-editor [(ngModel)]="content" [config]="editorConfig"></quill-editor>

        </div>
        <div class="form-group">
            <nb-card class="size-sm">
                <nb-card-body class="bg-white">
                    <label for="bannerImg" class="font-weight-bold" style="margin-top: 1rem;">Banner image</label> <br>
                    <div class="input-group">
                        <!-- <div class="input-group-prepend">
                            <span class="input-group-text" id="inputGroupFileAddon01">Upload</span>
                        </div> -->
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="inputGroupFile01"
                                aria-describedby="inputGroupFileAddon01" [(ngModel)]="bannerUrl" >
                                <!-- (change)="onFileChange($event)" -->
                            <label class="custom-file-label" for="inputGroupFile01">Choose image</label>
                            <img *ngIf="imageSrc" [src]="imageSrc">
                        </div>
                    </div>
                    <!-- <input id="bannerImg" type="file" (change)="onFileChange($event)" multiple="false"
                        accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" /> -->
                </nb-card-body>
            </nb-card>
            <nb-card class="size-sm">
                <nb-card-body class="bg-white">
                    <label for="bannerImg" class="font-weight-bold" style="margin-top: 1rem;">File urls</label> <br>
                    <div class="input-group">
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="inputGroupFile01"
                                aria-describedby="inputGroupFileAddon01" [(ngModel)]="fileUrls">
                            <label class="custom-file-label" for="inputGroupFile01">File urls</label>
                        </div>
                    </div>
                </nb-card-body>
            </nb-card>
        </div>
    </nb-card-body>
</nb-card>
</ng-template>
<ng-template #feedbackFormTemplate>
    <!-- <ngx-excel-importer (importFromExcel)="importFeedbackFromExcel($event)"></ngx-excel-importer> -->
    <button class="d-block mb-3 btn btn-outline-primary btn-sm" (click)="openDialog(importFeedbackFormDialog)">+ Add feedback</button>
    <div class="d-flex" *ngFor="let feedback of feedbackQuestionList; let i = index">
        <div class="container border mb-5 pt-3">
            <div class="label mb-2">Question {{i + 1}}</div>
            <div class="d-flex justify-content-between mb-3">
                <input class="flex-grow-1 mw-100" nbInput [(ngModel)]="feedback.question">
                <nb-select [(selected)]="feedback.type">
                    <nb-option value="MultipleSelect">Multiple Select</nb-option>
                    <nb-option value="SingleSelect">Single Select</nb-option>
                    <nb-option value="OpenEnded">Open Ended</nb-option>
                </nb-select>
            </div>
            <ng-container *ngIf="feedback.answer.length > 0">
                <div class="d-flex mb-2 ml-5" *ngFor="let answer of feedback.answer; let j = index">
                    <input class="flex-grow-1 mw-100" nbInput [(ngModel)]="feedback.answer[j]">
                    <button (click)="deleteAnswer(i, j)" class="btn input-group-text">
                        <nb-icon class="small" [icon]="'close'" pack="ion"></nb-icon>
                    </button>
                </div>
            </ng-container>
            <button (click)="addAnswer(i)" class="btn btn-link ml-5">
                <nb-icon status="primary" class="small mr-2" [icon]="'plus'" pack="ion"></nb-icon>
                <span class="label">Add answer</span>
            </button>
        </div>
        <button (click)="deleteQuestion(i)" class="btn">
            <nb-icon status="primary" class="" [icon]="'trash-a'" pack="ion"></nb-icon>
        </button>
    </div>
</ng-template>
<ng-template #attendanceListTemplate>
    <ngx-add-event-attendance-list (addAttendanceList)="addAttendanceList($event)"></ngx-add-event-attendance-list>
</ng-template>
<ng-template #tasksTemplate>
    <ngx-add-task></ngx-add-task>
</ng-template>

<!-- DIALOG -->

<ng-template #importFeedbackFormDialog let-ref="dialogRef">
    <nb-card>
        <nb-card-header>Add Feedback</nb-card-header>
        <nb-card-body>
            <button class="btn btn-outline-primary d-flex w-100 justify-content-center" (click)="addQuestion()">+ Add manually</button>
            <div class="d-flex justify-content-center my-2">or</div>
            <ngx-excel-importer
                sampleData="https://docs.google.com/spreadsheets/d/1zyKopWzyAkoPdjrvlGcrFcY3pX5TR2gdVLS6pP9FrMY/edit?usp=sharing"
                (importFromExcel)="importFeedbackFromExcel($event)"></ngx-excel-importer>
        </nb-card-body>
    </nb-card>
    
</ng-template>